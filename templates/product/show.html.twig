{% extends 'base.html.twig' %}

{% block body %}
    <h1>Commande</h1>

    <table class="table">
        <tbody>
            <tr>
                <th>Commande validée ?</th>
                <td>{{ product.isValid ? 'Oui' : 'Non' }}</td>
            </tr>
            <tr>
                <th>Commande payée ?</th>
                <td>{{ product.isPayed ? 'Oui' : 'Non' }}</td>
            </tr>
            <tr>
                <th>Commentaires</th>
                <td>{{ product.comment }}</td>
            </tr>
            <tr>
                <th>Etat de la commande</th>
                <td>{{ product.state }}</td>
            </tr>
            <tr>
                <th>Fichiers</th>
                {% for file in product.files %}
                    <th><a href="{{ path('app_userspace_downloadfile', {'file' : file.id, 'product': product.id }) }}">{{ file.name }}</a></th>
                {% else %}
                    <th>Pas de fichiers</th>
                {% endfor %}
            </tr>
        </tbody>
    </table>

    {% if product.bill is not null %}
        <button type="button"><a href="{{ path('app_userspace_downloadbill', {'product' : product.id, 'bill' : product.bill.id}) }}">Facture</a></button>
        {% if is_granted("ROLE_ADMIN") %}
            <a href="{{ path('app_adminspace_uploadbill', {'product': product.id}) }}">Changer la facture</a>
        {% endif %}
    {% endif %}

    {% if product.devis is not null %}
        <button type="button"><a href="{{ path('app_userspace_downloaddevis', {'product' : product.id, 'devis' : product.devis.id}) }}">Devis</a></button>
        {% if is_granted("ROLE_ADMIN") %}
            <a href="{{ path('app_adminspace_uploaddevis', {'product': product.id}) }}">Changer le devis</a>
        {% endif %}
    {% endif %}

    {% if not product.isValid or is_granted("ROLE_ADMIN") %}
        <a href="{{ path('app_userspace_editproduct', {'product': product.id }) }}">Modifier la commande</a>
    {% endif %}

    {% if is_granted("ROLE_ADMIN") %}
        <a href="{{ path('app_adminspace_products') }}">Retour sur la liste</a>
    {% endif %}

    {% if not is_granted("ROLE_ADMIN") %}
        {{ include('product/_delete_form.html.twig') }}
    {% endif %}
{% endblock %}
